name: Cron Job
on:
  schedule:
    - cron: '5 * * * *'
  workflow_dispatch:
    inputs:
      environment:
        required: true
        type: choice
        options:
          - cn1000
          - cn8000
        default: cn8000

jobs:
  set-variables:
    name: Set variables
    runs-on: ubuntu-latest
    outputs:
      environment: ${{ steps.set-output.outputs.environment }}
    steps:
      - name: Set default environment for scheduled workflow
        id: set-output
        run: |
          if [ "${{ github.event_name }}" == "schedule" ]; then
            echo "Scheduled run detected. Setting environment: cn1000"
            echo "environment=cn1000" >> $GITHUB_OUTPUT
          else [ "${{ github.event_name }}" == "workflow_dispatch" ]; then
            echo "Manual run detected. Setting environment to: ${{ github.event.inputs.environment }}"
            echo "environment=${{ github.event.inputs.environment }}" >> $GITHUB_OUTPUT


  hello_world:
    runs-on: ubuntu-latest
    needs: set-variables
    env:
      ENVIRONMENT: ${{ needs.set-variables.outputs.environment }}
    steps:
      - name: Echo current time
        run: |
          echo "Starting the line"
          echo $ENVIRONMENT

